}
std.errors
# Std. Error = summary(sim.mods[[1]])$coefficients[i,2] where i is the row of the variable you care about
sim.std.errors <- list()
for (i in 1:no.sim){
for (j in 1:5){
sim.std.errors[[i]][j] <- summary(sim.mods[[i]])$coefficients[j,2]
}
}
for (i in 1:no.sim){
for (j in 1:5){
sim.std.errors[i][j] <- summary(sim.mods[[i]])$coefficients[j,2]
}
}
for (i in 1:no.sim){
for (j in 1:5){
sim.std.errors[[i]][j] <- summary(sim.mods[[i]])$coefficients[j,2]
}
}
sim.std.errors
sim.mod.coeffs
colnames(sim.std.errors) <- c('(Intercept)', 'Q71', 'ZAlcTox', 'Day', 'Q71:Day')
sim.mod.coeffs[[1]][1]
sim.std.errors[[1]][1]
sim.cis <- list()
for (i in 1:no.sim){
for (j in 1:5){
sim.cis[i][j]['L'] <- sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j]
sim.cis[i][j]['U'] <- sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j]
}
}
for (i in 1:no.sim){
for (j in 1:5){
sim.cis[[i]][j]['L'] <- sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j]
sim.cis[[i]][j]['U'] <- sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j]
}
}
sim.cis
for (i in 1:no.sim){
for (j in 1:5){
sim.cis[[i]][[j]]['L'] <- sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j]
sim.cis[[i]][[j]]['U'] <- sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j]
}
}
sim.cis
sim.cis <- list()
for (i in 1:no.sim){
for (j in 1:5){
sim.cis[i][j] <- c(sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j],sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j])
}
}
for (i in 1:no.sim){
for (j in 1:5){
sim.cis[[i]][j] <- c(sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j],sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j])
}
}
sim.cis
for (i in 1:no.sim){
for (j in 1:5){
sim.cis[[i]][j] <- c((sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j]),(sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j]))
}
}
sim.cis
for (i in 1:no.sim){
for (j in 1:5){
sim.cis[[i]][j] <- list((sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j]),(sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j]))
}
}
sim.cis
sim.mod.coeffs[[1]]
for (i in 1:no.sim){
for (j in 1:5){
sim.cis[[i]][[j]][1] <- sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j]
sim.cis[[i]][[j]][2] <- sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j]
}
}
sim.cis
sim.cis <- list()
for (i in 1:no.sim){
for (j in 1:5){
sim.cis[[i]][[j]][1] <- sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j]
sim.cis[[i]][[j]][2] <- sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j]
}
}
for (i in 1:no.sim){
for (j in 1:5){
sim.cis[i][[j]][1] <- sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j]
sim.cis[i][[j]][2] <- sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j]
}
}
for (i in 1:no.sim){
for (j in 1:5){
sim.cis[i][j][1] <- sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j]
sim.cis[i][j][2] <- sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j]
}
}
for (i in 1:no.sim){
for (j in 1:5){
sim.cis[[i]][[j]][1] <- sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j]
sim.cis[[i]][[j]][2] <- sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j]
}
}
sim.ciks
sim.cis
for (i in 1:no.sim){
for (j in 1:5){
sim.cis[[i]][[j]][1] <- sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j]
sim.cis[[i]][[j]][2] <- sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j]
}
}
for (i in 1:no.sim){
for (j in 1:5){
sim.cis[[i]][j][1] <- sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j]
sim.cis[[i]][j][2] <- sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j]
}
}
sim.cis
for (i in 1:no.sim){
for (j in 1:5){
sim.cis[[i]][[j]][1] <- sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j]
sim.cis[[i]][[j]][2] <- sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j]
}
}
for (i in 1:no.sim){
for (j in 1:5){
sim.cis[[i]][[j]][1] <- c(sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j])
sim.cis[[i]][[j]][2] <- c(sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j])
}
}
sim.cis
for (i in 1:no.sim){
for (j in 1:5){
L[j] <- c(sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j])
U[j] <- c(sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j])
sim.cis[[i]][[j]] <- cbind(L,U)
}
}
for (i in 1:no.sim){
L <- list()
U <- list()
for (j in 1:5){
L[j] <- c(sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j])
U[j] <- c(sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j])
sim.cis[[i]][[j]] <- cbind(L,U)
}
}
for (i in 1:no.sim){
L <- list()
U <- list()
for (j in 1:5){
L[j] <- c(sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j])
U[j] <- c(sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j])
sim.cis[[i]][j] <- cbind(L,U)
}
}
sim.cis
for (i in 1:no.sim){
for (j in 1:5){
L[j] <- c(sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j])
U[j] <- c(sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j])
sim.cis[[i]][j] <- cbind(L,U)
}
}
sim.cis
for (i in 1:no.sim){
for (j in 1:5){
L <- c(sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j])
U <- c(sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j])
sim.cis[[i]][j] <- cbind(L,U)
}
}
sim.cis
L
U
for (i in 1:no.sim){
for (j in 1:5){
L <- c(sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j])
U <- c(sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j])
sim.cis[[i]][j] <- rbind(L,U)
}
}
sim.cis
L
U
?cbind
for (i in 1:no.sim){
for (j in 1:5){
L <- c(sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j])
U <- c(sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j])
sim.cis[[i]][[j]] <- rbind(L,U)
}
}
sim.cis
for (i in 1:no.sim){
for (j in 1:5){
L <- c(sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j])
U <- c(sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j])
sim.cis[[i]][[j]] <- cbind(L,U)
}
}
sim.cis
sim.cis <- list()
for (i in 1:no.sim){
for (j in 1:5){
L <- c(sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j])
U <- c(sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j])
sim.cis[[i]][[j]] <- cbind(L,U)
}
}
for (i in 1:no.sim){
for (j in 1:5){
L <- c(sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j])
U <- c(sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j])
sim.cis[i][j] <- cbind(L,U)
}
}
for (i in 1:no.sim){
for (j in 1:5){
L <- c(sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j])
U <- c(sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j])
sim.cis[[i]][[j]] <- cbind(L,U)
}
}
analyze.comp <- function(df, ...) {
fit <- glmer(data=df, MissedDose~DrinkYN+ZAlcTox+Day+(1|PID), family=binomial(link=logit),
control=glmerControl(optimizer='bobyqa', optCtrl = list(maxfun=2000)))
g0.est <- summary(fit)$coefficients[1,1]
g0.se <- summary(fit)$coefficients[1,2]
g0.L <- g0.est - 1.96*g0.se
g0.U <- g0.est + 1.96*g0.se
b1.est <- summary(fit)$coefficients[2,1]
b1.se <- summary(fit)$coefficients[2,2]
b1.L <- b1.est - 1.96*b1.se
b1.U <- b1.est + 1.96*b1.se
b2.est <- summary(fit)$coefficients[3,1]
b2.se <- summary(fit)$coefficients[3,2]
b2.L <- b2.est - 1.96*b2.se
b2.U <- b2.est + 1.96*b2.se
b3.est <- summary(fit)$coefficients[4,1]
b3.se <- summary(fit)$coefficients[4,2]
b3.L <- b3.est - 1.96*b3.se
b3.U <- b3.est + 1.96*b3.se
c(g0.est, g0.L, g0.U, b1.est, b1.L, b1.U, b2.est, b2.L, b2.U, b3.est, b3.L, b3.U)
}
for (i in 1:no.sim){
for (j in 1:5){
L <- c(sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j])
U <- c(sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j])
sim.cis[[i]][[j]] <- cbind(L,U)
}
}
L
U
for (i in 1:no.sim){
for (j in 1:5){
L <- c(sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j])
U <- c(sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j])
sim.cis[[i]][[j]] <- cbind(L,U)
}
}
for (i in 1:no.sim){
for (j in 1:5){
L <- c(sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j])
U <- c(sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j])
sim.cis[[i]][j] <- cbind(L,U)
}
}
for (i in 1:no.sim){
for (j in 1:5){
L <- c(sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j])
U <- c(sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j])
sim.cis[[i]][[j]] <- cbind(L,U)
}
}
for (i in 1:no.sim){
for (j in 1:5){
L <- c(sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j])
U <- c(sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j])
sim.cis[[i]][[j]] <- list(L,U)
}
}
sim.cis
for (i in 1:no.sim){
for (j in 1:5){
L <- c(sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j])
U <- c(sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j])
sim.cis[[i]][j] <- cbind(L,U)
}
}
sim.cis
for (i in 1:no.sim){
for (j in 1:5){
L <- c(sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j])
U <- c(sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j])
sim.cis[[i]][[j]] <- cbind(L,U)
}
}
sim.cis
for (i in 1:no.sim){
for (j in 1:5){
L <- c(sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j])
U <- c(sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j])
sim.cis[[i]][[j]] <- L
}
}
sim.cis
for (i in 1:no.sim){
for (j in 1:5){
L <- c(sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j])
U <- c(sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j])
sim.cis[[i]][[j]] <- cbind(L,U)
}
}
for (i in 1:no.sim){
for (j in 1:5){
L <- c(sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j])
U <- c(sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j])
sim.cis[i][[j]] <- cbind(L,U)
}
}
sim.cis
sim.cis <- list()
for (i in 1:no.sim){
for (j in 1:5){
L <- c(sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j])
U <- c(sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j])
sim.cis[i][[j]] <- cbind(L,U)
}
}
sim.cis
for (i in 1:no.sim){
for (j in 1:5){
Est <- sim.mod.coeffs[[i]][j]
L <- c(sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j])
U <- c(sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j])
sim.cis[i][[j]] <- cbind(Est,L,U)
}
}
warnings()
sim.cis
for (i in 1:no.sim){
for (j in 1:5){
Est <- sim.mod.coeffs[[i]][j]
L <- c(sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j])
U <- c(sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j])
sim.cis[[i]][[j]] <- cbind(Est,L,U)
}
}
sim.cis
for (i in 1:no.sim){
for (j in 1:5){
Est <- sim.mod.coeffs[[i]][j]
L <- c(sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j])
U <- c(sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j])
sim.cis[i][[j]] <- cbind(Est,L,U)
}
}
sim.cis
for (i in 1:no.sim){
for (j in 1:5){
Est <- sim.mod.coeffs[[i]][j]
L <- c(sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j])
U <- c(sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j])
sim.cis[i][j] <- cbind(Est,L,U)
}
}
sim.cis
for (i in 1:no.sim){
for (j in 1:5){
Est <- sim.mod.coeffs[[i]][j]
L <- c(sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j])
U <- c(sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j])
sim.cis[i][[j]] <- cbind(Est,L,U)
}
}
for (i in 1:no.sim){
ci <- list()
for (j in 1:5){
Est <- sim.mod.coeffs[[i]][j]
L <- c(sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j])
U <- c(sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j])
ci[[j]] <- cbind(Est,L,U)
}
ci[[i]] <- ci
}
for (i in 1:no.sim){
ci <- list()
for (j in 1:5){
Est <- sim.mod.coeffs[[i]][j]
L <- c(sim.mod.coeffs[[i]][j] - sim.std.errors[[i]][j])
U <- c(sim.mod.coeffs[[i]][j] + sim.std.errors[[i]][j])
ci[[j]] <- cbind(Est,L,U)
}
sim.cis[[i]] <- ci
}
sim.cis
split.coeff.means
sim.cis[[1]]
split.coeff.means[[1]][[1]]
split.coeff.means
split.coeff.means[[1]][1
]
split.coeff.means[[1]][1][1]
split.coeff.means[[1]][[1]][1]
split.coeff.means[1]
split.coeff.means[1][1]
split.coeff.means[1][[1]]
split.coeff.means[1][[1]][1]
split.coeff.means[[1]][[1]][1]
split.coeff.means[[1]][[1]][2]
split.coeff.means[[2]][[1]][2]
sim.cis[[1]]
sim.cis[[2]]
sim.cis[[2]][1]
sim.cis[[2]][1][1]
sim.cis[[2]][1]['L']
sim.cis[[2]][1][,2]
sim.cis[[2]][[1]][1]
sim.cis[[2]][[1]][2]
fits <- list()
for (i in 1:no.sim){
incl <- list()
for (j in 1:5){
incl[[j]] <- (split.coeff.means[[i]][[1]][j] >= sim.cis[[i]][[j]][2]) & (split.coeff.means[[i]][[1]][j] <= sim.cis[[i]][[j]][3])
}
fits[[i]] <- incl
}
fits
for (i in 1:no.sim){
incl <- list()
for (j in 1:5){
incl[[j]] <- (split.coeff.means[[i]][[1]][j] >= sim.cis[[i]][[j]][2]) & (split.coeff.means[[i]][[1]][j] <= sim.cis[[i]][[j]][3])
}
fits[[i]] <- cbind(sim.cis,incl)
}
fits
for (i in 1:no.sim){
incl <- list()
for (j in 1:5){
incl[[j]] <- (split.coeff.means[[i]][[1]][j] >= sim.cis[[i]][[j]][2]) & (split.coeff.means[[i]][[1]][j] <= sim.cis[[i]][[j]][3])
}
fits[[i]] <- incl
}
fits
as.data.frame(fits)
as.data.frame(transpose(fits))
split.fits <- list()
for (i in 1:no.sim){
incl <- list()
for (j in 1:5){
incl[[j]] <- (split.coeff.means[[i]][[1]][j] >= sim.cis[[i]][[j]][2]) & (split.coeff.means[[i]][[1]][j] <= sim.cis[[i]][[j]][3])
}
split.fits[[i]] <- incl
}
split.fits[[1]]
rbind(split.fits[[1]])
cbind(split.fits[[1]])
for (i in 1:no.sim){
incl <- list()
for (j in 1:5){
incl[[j]] <- (split.coeff.means[[i]][[1]][j] >= sim.cis[[i]][[j]][2]) & (split.coeff.means[[i]][[1]][j] <= sim.cis[[i]][[j]][3])
}
split.fits[[i]] <- rbind(incl)
}
split.fits[[1]]
for (i in 1:no.sim){
incl <- list()
for (j in 1:5){
incl[[j]] <- (split.coeff.means[[i]][[1]][j] >= sim.cis[[i]][[j]][2]) & (split.coeff.means[[i]][[1]][j] <= sim.cis[[i]][[j]][3])
}
split.fits[[i]] <- incl
}
split.fits[[1]]
rbind(split.fits)
library(beepr)
install.packages('beeper')
library(beepr)
full.res <- lapply(sim.data, function(x) {analyze.comp(x)})
analyze.comp <- function(df, ...) {
fit <- glm(data=df, MissedDose~Q7+ZAlcTox+Day+Q7*Day, family=binomial(link=logit))
g0.est <- summary(fit)$coefficients[1,1]
g0.se <- summary(fit)$coefficients[1,2]
g0.L <- g0.est - 1.96*g0.se
g0.U <- g0.est + 1.96*g0.se
b1.est <- summary(fit)$coefficients[2,1]
b1.se <- summary(fit)$coefficients[2,2]
b1.L <- b1.est - 1.96*b1.se
b1.U <- b1.est + 1.96*b1.se
b2.est <- summary(fit)$coefficients[3,1]
b2.se <- summary(fit)$coefficients[3,2]
b2.L <- b2.est - 1.96*b2.se
b2.U <- b2.est + 1.96*b2.se
b3.est <- summary(fit)$coefficients[4,1]
b3.se <- summary(fit)$coefficients[4,2]
b3.L <- b3.est - 1.96*b3.se
b3.U <- b3.est + 1.96*b3.se
c(g0.est, g0.L, g0.U, b1.est, b1.L, b1.U, b2.est, b2.L, b2.U, b3.est, b3.L, b3.U)
}
full.res <- lapply(sim.data, function(x) {analyze.comp(x)})
mean(unlist(lapply(full.res, function(x) {abs(x[10]-(0.2))})))
mean(unlist(lapply(full.res, function(x) {abs(x[10]-(0.2))/0.2})))          # What is this???
mean(unlist(lapply(full.res, function(x) {(x[10]-(0.2))**2})))
mean(unlist(lapply(full.res, function(x) {(x[11]<0.2)&(x[12]>0.2)})))
mean(unlist(lapply(full.res, function(x) {x[12]-x[11]})))
mi.ml <- function(set,...) {
fit <- with(set, glmer(MissedDose~DrinkYN+ZAlcTox+Day+(1 |PID), family=binomial(link=logit),
control=glmerControl(optimizer='bobyqa', optCtrl = list(maxfun=2000))))
p <- pool(fit)
res <- summary(p)
c(res[1,1], res[1,6], res[1,7], res[1,9], res[2,1], res[2,6], res[2,7], res[2,9],
res[3,1], res[3,6], res[3,7], res[3,9], res[4,1], res[4,6], res[4,7], res[4,9])
}
