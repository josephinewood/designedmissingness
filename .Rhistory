<<<<<<< HEAD
getwd()
install.packages("xtable")
d <- load("~/designedmissingnessGit/Results/tables20180509_60_1_high.RData")
high <- d
load("~/designedmissingnessGit/Results/tables20180509_60_1_med.RData")
med <- d
load("~/designedmissingnessGit/Results/tables20180509_60_1_low.RData")
low <- d
library(xtable)
print(xtable(cbind("","","",rbind(low[[1]],med[[1]],high[[1]],low[[2]],med[[2]],high[[2]],low[[3]],med[[3]],high[[3]])),digits= 3),include.rownames=FALSE)
load("~/designedmissingnessGit/Results/tables20180509_60_1_high_hightime1.RData")
high <- d
load("~/designedmissingnessGit/Results/tables20180509_60_1_med_hightime1.RData")
med <- d
load("~/designedmissingnessGit/Results/tables20180509_60_1_low_hightime1.RData")
low <- d
library(xtable)
print(xtable(cbind("","","",rbind(low[[1]],med[[1]],high[[1]],low[[2]],med[[2]],high[[2]],low[[3]],med[[3]],high[[3]])),digits= 3),include.rownames=FALSE)
high <- d
getwd()
getwd(../)
cd ../
d <- load("~/../Results/tables20180509_60_1_high.RData")
d <- load("~/GitHub/designedmissingness//Results/tables20180509_60_1_high.RData")
d
load("~/GitHub/designedmissingness//Results/tables20180509_60_1_high.RData")
load("~/GitHub/designedmissingness//Results/tables20180509_60_1_high.RData")
getwd()
getwd()
if (Sys.info()[8] == "Josie"){
setwd("~/GitHub/designedmissingness")
}
getwd()
load("~/Results/tables20180509_60_1_high.RData")
library(ggplot2)
library(dplyr)
library(reshape2)
datmelt <- alternate.split.dat[1:8] %>% is.na %>% melt
colnames(datmelt) <- c("Day","Question","Missing")
#datmelt$block <- ifelse((datmelt$Question=="Q1")|(datmelt$Question=="Q8"),"X",ifelse((datmelt$Question=="Q2")|(datmelt$Question=="Q3"),"A",ifelse((datmelt$Question=="Q4")|(datmelt$Question=="Q5"),"B",ifelse((datmelt$Question=="Q6")|(datmelt$Question=="Q7"),"C",0))))
datmelt$color <- ifelse(datmelt$Missing == "TRUE", "Missing", "Observed")
#ifelse(datmelt$Missing == "TRUE", "Missing", ifelse(datmelt$block == "X","X",ifelse(datmelt$block == "A","A",ifelse(datmelt$block == "B","B",ifelse(datmelt$block == "C","C","Missing")))))
cols <- c("Missing" = "red", "Observed" = "skyblue3")
alternatesplitplot <- ggplot(datmelt, aes(Question, Day, fill=color)) + geom_raster() + scale_fill_manual(values = cols)  + theme(axis.text.x = element_text(angle=45, vjust=0.5),panel.background = element_rect(fill = NA)) + labs(x = "Questions Asked",y = "Day",fill="Block") + scale_y_reverse() + theme(legend.title=element_blank(),legend.position="none")
grid.arrange(splitplot, alternatesplitplot, waveplot, ncol=3)
require(gridExtra)
grid.arrange(splitplot, alternatesplitplot, waveplot, ncol=3)
@
grid.arrange(splitplot, alternatesplitplot, waveplot, ncol=3)
=======
}
if (dat$Name[i] == "Trump International Hotel and Tower"){
col <- rgb(0, (dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20,alpha)
polygon(c(-1.25,1.25,1.25,-1.25)*0.001 + dat$lat[i] ,c(0,0,246,246) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1,1,1,-1)*0.001 + dat$lat[i] ,c(246,246,410,410) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.75,.75,.75,-.75)*0.001 + dat$lat[i] ,c(410,410,705,705) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.75,.75,.75,-.75)*0.001 + dat$lat[i] ,c(705,705,1164.7,1164.7) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.5,.5,.5,-.5)*0.001 + dat$lat[i] ,c(1164.7,1164.7,1171,1171) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001  + dat$lat[i] ,c(1171,1171,1388,1388) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
}
if (dat$Name[i] == "Two Prudential Plaza"){print("greg")
col <- rgb((dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20,alpha)
polygon(c(-.05,.05,.05,-.05)*0.001  + dat$lat[i] ,c(995-80,995-80,995,995) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.5,.5,0.05,-0.05)*0.001  + dat$lat[i] ,c(dat$height[i],dat$height[i],995-80,995-80) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
#text(dat$lat[i],dat$height[i],dat$Name[i],srt = 90)
}
}
dat <- dat[order(dat$long),]
alpha <- 0.75
plot(0,0,xlim = c(41.875,41.905),ylim = c(-500,1560),frame.plot= FALSE, xlab = "", ylab = "", yaxt= 'n',xaxt='n',asp = 1/150000,col="white")
col <- rgb(0, (dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20,alpha)
polygon(c(-1.25,1.25,1.25,-1.25)*0.001 + dat$lat[i] ,c(0,0,246,246) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1,1,1,-1)*0.001 + dat$lat[i] ,c(246,246,410,410) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.75,.75,.75,-.75)*0.001 + dat$lat[i] ,c(410,410,705,705) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.75,.75,.75,-.75)*0.001 + dat$lat[i] ,c(705,705,1164.7,1164.7) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1.5,1,1,-1.5)*0.001 + dat$lat[i] ,c(246,246,410,410) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
dat <- dat[order(dat$long),]
alpha <- 0.75
plot(0,0,xlim = c(41.875,41.905),ylim = c(-500,1560),frame.plot= FALSE, xlab = "", ylab = "", yaxt= 'n',xaxt='n',asp = 1/150000,col="white")
polygon(c(-1.5,1.5,1.5,-1.5)*0.001 + dat$lat[i] ,c(0,0,246,246) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1.5,1,1,-1.5)*0.001 + dat$lat[i] ,c(246,246,410,410) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1,1,1,-1)*0.001 + dat$lat[i] ,c(410,410,705,705) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.5,1,1,-.5)*0.001 + dat$lat[i] ,c(705,705,1164.7,1164.7) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
dat <- dat[order(dat$long),]
alpha <- 0.75
plot(0,0,xlim = c(41.875,41.905),ylim = c(-500,1560),frame.plot= FALSE, xlab = "", ylab = "", yaxt= 'n',xaxt='n',asp = 1/150000,col="white")
polygon(c(-1.5,1.5,1.5,-1.5)*0.001 + dat$lat[i] ,c(0,0,246,246) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1.5,1,1,-1.5)*0.001 + dat$lat[i] ,c(246,246,410,410) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1,1,1,-1)*0.001 + dat$lat[i] ,c(410,410,705,705) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1,.5,.5,-1)*0.001 + dat$lat[i] ,c(705,705,1164.7,1164.7) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.5,.5,.5,-.5)*0.001 + dat$lat[i] ,c(1164.7,1164.7,1171,1171) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.5,.5,.5,-.5)*0.001 + dat$lat[i] ,c(1164.7,1164.7,1171,1171) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1,.5,.5,-1)*0.001 + dat$lat[i] ,c(705,705,1164.7,1164.7) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.5,.5,.5,-.5)*0.001 + dat$lat[i] ,c(1164.7,1164.7,1171,1171) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001  + dat$lat[i] ,c(1171,1171,1388,1388) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
dat <- dat[order(dat$long),]
alpha <- 0.75
plot(0,0,xlim = c(41.875,41.905),ylim = c(-500,1560),frame.plot= FALSE, xlab = "", ylab = "", yaxt= 'n',xaxt='n',asp = 1/150000,col="white")
col <- rgb(0, (dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20,alpha)
polygon(c(-1.5,1.5,1.5,-1.5)*0.001 + dat$lat[i] ,c(0,0,246,246) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1.5,1,1,-1.5)*0.001 + dat$lat[i] ,c(246,246,410,410) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1,1,1,-1)*0.001 + dat$lat[i] ,c(410,410,705,705) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1,.5,.5,-1)*0.001 + dat$lat[i] ,c(705,705,1164.7,1164.7) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.5,.5,.5,-.5)*0.001 + dat$lat[i] ,c(1164.7,1164.7,1171,1171) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001  + dat$lat[i] ,c(1171,1171,1388,1388) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
dat <- dat[order(dat$long),]
alpha <- 0.75
plot(0,0,xlim = c(41.875,41.905),ylim = c(-500,1560),frame.plot= FALSE, xlab = "", ylab = "", yaxt= 'n',xaxt='n',asp = 1/150000,col="white")
col <- rgb(0, (dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20,alpha)
polygon(c(-1.5,1.5,1.5,-1.5)*0.001 + dat$lat[i] ,c(0,0,246,246) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1.5,1,1,-1.5)*0.001 + dat$lat[i] ,c(246,246,410,410) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1,1,1,-1)*0.001 + dat$lat[i] ,c(410,410,705,705) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1,.5,.5,-1)*0.001 + dat$lat[i] ,c(705,705,1164.7,1164.7) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.5,.5,.5,-.5)*0.001 + dat$lat[i] ,c(1116,1116,1171,1171) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1,.5,.5,-1)*0.001 + dat$lat[i] ,c(705,705,1116,1116) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.5,.5,.5,-.5)*0.001 + dat$lat[i] ,c(1116,1116,1171,1171) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
dat <- dat[order(dat$long),]
alpha <- 0.75
plot(0,0,xlim = c(41.875,41.905),ylim = c(-500,1560),frame.plot= FALSE, xlab = "", ylab = "", yaxt= 'n',xaxt='n',asp = 1/150000,col="white")
col <- rgb(0, (dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20,alpha)
polygon(c(-1.5,1.5,1.5,-1.5)*0.001 + dat$lat[i] ,c(0,0,246,246) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1.5,1,1,-1.5)*0.001 + dat$lat[i] ,c(246,246,410,410) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1,1,1,-1)*0.001 + dat$lat[i] ,c(410,410,705,705) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1,.5,.5,-1)*0.001 + dat$lat[i] ,c(705,705,1116,1116) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.5,.5,.5,-.5)*0.001 + dat$lat[i] ,c(1116,1116,1171,1171) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001  + dat$lat[i] ,c(1171,1171,1388,1388) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
dat <- dat[order(dat$long),]
alpha <- 0.75
plot(0,0,xlim = c(41.875,41.905),ylim = c(-500,1560),frame.plot= FALSE, xlab = "", ylab = "", yaxt= 'n',xaxt='n',asp = 1/150000,col="white")
for (i in 1:nrow(dat)){
col <- rgb((dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20, alpha)
if (dat$Name[i] == "CNA Center"){col <- rgb((dat$long[i] + 87.65) * 20, 0,0,alpha)}
if (dat$Name[i] == "Trump International Hotel and Tower"){col <- rgb(0,(dat$long[i] + 87.65) * 20,(dat$long[i] + 87.65) * 20,alpha)}
if (dat$Name[i] == "Willis Tower"){col <- rgb(0, 0,0)}
if (dat$Name[i] == "875 North Michigan Avenue"){col <- rgb(0, 0,0)}
polygon(c(-0.5,0.5,0.5,-0.5)*0.001 + dat$lat[i] ,c(0,0,dat$height[i],dat$height[i]) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
if (dat$Name[i] == "875 North Michigan Avenue"){
polygon(c(-1,1,0.5,-0.5)*0.001 + dat$lat[i] ,c(0,0,dat$height[i],dat$height[i]) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001 - 0.005*0.05 + dat$lat[i] ,c(dat$height[i],dat$height[i],1500,1500) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001 + 0.005*0.05 + dat$lat[i] ,c(dat$height[i],dat$height[i],1500,1500) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
}
if (dat$Name[i] == "Willis Tower"){
polygon(c(-1,1,1,-1)*0.001 + dat$lat[i] ,c(0,0,656.168,656.168) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.75,.75,.75,-.75)*0.001 + dat$lat[i] ,c(0,0,1164.7,1164.7) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001 - 0.005*0.05 + dat$lat[i] ,c(0,0,1729,1729) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001 + 0.005*0.05 + dat$lat[i] ,c(0,0,1729,1729) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
}
if (dat$Name[i] == "Trump International Hotel and Tower"){
col <- rgb(0, (dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20,alpha)
polygon(c(-1.5,1.5,1.5,-1.5)*0.001 + dat$lat[i] ,c(0,0,246,246) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1.5,1,1,-1.5)*0.001 + dat$lat[i] ,c(246,246,410,410) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1,1,1,-1)*0.001 + dat$lat[i] ,c(410,410,705,705) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1,.5,.5,-1)*0.001 + dat$lat[i] ,c(705,705,1116,1116) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.5,.5,.5,-.5)*0.001 + dat$lat[i] ,c(1116,1116,1171,1171) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001  + dat$lat[i] ,c(1171,1171,1388,1388) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
}
if (dat$Name[i] == "Two Prudential Plaza"){print("greg")
col <- rgb((dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20,alpha)
polygon(c(-.05,.05,.05,-.05)*0.001  + dat$lat[i] ,c(995-80,995-80,995,995) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.5,.5,0.05,-0.05)*0.001  + dat$lat[i] ,c(dat$height[i],dat$height[i],995-80,995-80) - 0*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
#text(dat$lat[i],dat$height[i],dat$Name[i],srt = 90)
}
}
dat <- dat[order(dat$long),]
alpha <- 0.75
offset <- 20
plot(0,0,xlim = c(41.875,41.905),ylim = c(-500,1560),frame.plot= FALSE, xlab = "", ylab = "", yaxt= 'n',xaxt='n',asp = 1/150000,col="white")
for (i in 1:nrow(dat)){
col <- rgb((dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20, alpha)
if (dat$Name[i] == "CNA Center"){col <- rgb((dat$long[i] + 87.65) * 20, 0,0,alpha)}
if (dat$Name[i] == "Trump International Hotel and Tower"){col <- rgb(0,(dat$long[i] + 87.65) * 20,(dat$long[i] + 87.65) * 20,alpha)}
if (dat$Name[i] == "Willis Tower"){col <- rgb(0, 0,0)}
if (dat$Name[i] == "875 North Michigan Avenue"){col <- rgb(0, 0,0)}
polygon(c(-0.5,0.5,0.5,-0.5)*0.001 + dat$lat[i] ,c(0,0,dat$height[i],dat$height[i]) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
if (dat$Name[i] == "875 North Michigan Avenue"){
polygon(c(-1,1,0.5,-0.5)*0.001 + dat$lat[i] ,c(0,0,dat$height[i],dat$height[i]) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001 - 0.005*0.05 + dat$lat[i] ,c(dat$height[i],dat$height[i],1500,1500) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001 + 0.005*0.05 + dat$lat[i] ,c(dat$height[i],dat$height[i],1500,1500) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
}
if (dat$Name[i] == "Willis Tower"){
polygon(c(-1,1,1,-1)*0.001 + dat$lat[i] ,c(0,0,656.168,656.168) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.75,.75,.75,-.75)*0.001 + dat$lat[i] ,c(0,0,1164.7,1164.7) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001 - 0.005*0.05 + dat$lat[i] ,c(0,0,1729,1729) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001 + 0.005*0.05 + dat$lat[i] ,c(0,0,1729,1729) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
}
if (dat$Name[i] == "Trump International Hotel and Tower"){
col <- rgb(0, (dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20,alpha)
polygon(c(-1.5,1.5,1.5,-1.5)*0.001 + dat$lat[i] ,c(0,0,246,246) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1.5,1,1,-1.5)*0.001 + dat$lat[i] ,c(246,246,410,410) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1,1,1,-1)*0.001 + dat$lat[i] ,c(410,410,705,705) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1,.5,.5,-1)*0.001 + dat$lat[i] ,c(705,705,1116,1116) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.5,.5,.5,-.5)*0.001 + dat$lat[i] ,c(1116,1116,1171,1171) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001  + dat$lat[i] ,c(1171,1171,1388,1388) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
}
if (dat$Name[i] == "Two Prudential Plaza"){print("greg")
col <- rgb((dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20,alpha)
polygon(c(-.05,.05,.05,-.05)*0.001  + dat$lat[i] ,c(995-80,995-80,995,995) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.5,.5,0.05,-0.05)*0.001  + dat$lat[i] ,c(dat$height[i],dat$height[i],995-80,995-80) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
#text(dat$lat[i],dat$height[i],dat$Name[i],srt = 90)
}
}
dat <- dat[order(dat$long),]
alpha <- 0.75
offset <- 0.5
plot(0,0,xlim = c(41.875,41.905),ylim = c(-500,1560),frame.plot= FALSE, xlab = "", ylab = "", yaxt= 'n',xaxt='n',asp = 1/150000,col="white")
for (i in 1:nrow(dat)){
col <- rgb((dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20, alpha)
if (dat$Name[i] == "CNA Center"){col <- rgb((dat$long[i] + 87.65) * 20, 0,0,alpha)}
if (dat$Name[i] == "Trump International Hotel and Tower"){col <- rgb(0,(dat$long[i] + 87.65) * 20,(dat$long[i] + 87.65) * 20,alpha)}
if (dat$Name[i] == "Willis Tower"){col <- rgb(0, 0,0)}
if (dat$Name[i] == "875 North Michigan Avenue"){col <- rgb(0, 0,0)}
polygon(c(-0.5,0.5,0.5,-0.5)*0.001 + dat$lat[i] ,c(0,0,dat$height[i],dat$height[i]) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
if (dat$Name[i] == "875 North Michigan Avenue"){
polygon(c(-1,1,0.5,-0.5)*0.001 + dat$lat[i] ,c(0,0,dat$height[i],dat$height[i]) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001 - 0.005*0.05 + dat$lat[i] ,c(dat$height[i],dat$height[i],1500,1500) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001 + 0.005*0.05 + dat$lat[i] ,c(dat$height[i],dat$height[i],1500,1500) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
}
if (dat$Name[i] == "Willis Tower"){
polygon(c(-1,1,1,-1)*0.001 + dat$lat[i] ,c(0,0,656.168,656.168) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.75,.75,.75,-.75)*0.001 + dat$lat[i] ,c(0,0,1164.7,1164.7) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001 - 0.005*0.05 + dat$lat[i] ,c(0,0,1729,1729) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001 + 0.005*0.05 + dat$lat[i] ,c(0,0,1729,1729) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
}
if (dat$Name[i] == "Trump International Hotel and Tower"){
col <- rgb(0, (dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20,alpha)
polygon(c(-1.5,1.5,1.5,-1.5)*0.001 + dat$lat[i] ,c(0,0,246,246) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1.5,1,1,-1.5)*0.001 + dat$lat[i] ,c(246,246,410,410) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1,1,1,-1)*0.001 + dat$lat[i] ,c(410,410,705,705) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1,.5,.5,-1)*0.001 + dat$lat[i] ,c(705,705,1116,1116) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.5,.5,.5,-.5)*0.001 + dat$lat[i] ,c(1116,1116,1171,1171) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001  + dat$lat[i] ,c(1171,1171,1388,1388) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
}
if (dat$Name[i] == "Two Prudential Plaza"){print("greg")
col <- rgb((dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20,alpha)
polygon(c(-.05,.05,.05,-.05)*0.001  + dat$lat[i] ,c(995-80,995-80,995,995) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.5,.5,0.05,-0.05)*0.001  + dat$lat[i] ,c(dat$height[i],dat$height[i],995-80,995-80) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
#text(dat$lat[i],dat$height[i],dat$Name[i],srt = 90)
}
}
dat <- dat[order(-dat$height),]
dat <- dat[order(dat$long),]
alpha <- 0.75
offset <- 1
plot(0,0,xlim = c(41.875,41.905),ylim = c(-500,1560),frame.plot= FALSE, xlab = "", ylab = "", yaxt= 'n',xaxt='n',asp = 1/150000,col="white")
for (i in 1:nrow(dat)){
col <- rgb((dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20, alpha)
if (dat$Name[i] == "CNA Center"){col <- rgb((dat$long[i] + 87.65) * 20, 0,0,alpha)}
if (dat$Name[i] == "Trump International Hotel and Tower"){col <- rgb(0,(dat$long[i] + 87.65) * 20,(dat$long[i] + 87.65) * 20,alpha)}
if (dat$Name[i] == "Willis Tower"){col <- rgb(0, 0,0)}
if (dat$Name[i] == "875 North Michigan Avenue"){col <- rgb(0, 0,0)}
polygon(c(-0.5,0.5,0.5,-0.5)*0.001 + dat$lat[i] ,c(0,0,dat$height[i],dat$height[i]) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
if (dat$Name[i] == "875 North Michigan Avenue"){
polygon(c(-1,1,0.5,-0.5)*0.001 + dat$lat[i] ,c(0,0,dat$height[i],dat$height[i]) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001 - 0.005*0.05 + dat$lat[i] ,c(dat$height[i],dat$height[i],1500,1500) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001 + 0.005*0.05 + dat$lat[i] ,c(dat$height[i],dat$height[i],1500,1500) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
}
if (dat$Name[i] == "Willis Tower"){
polygon(c(-1,1,1,-1)*0.001 + dat$lat[i] ,c(0,0,656.168,656.168) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.75,.75,.75,-.75)*0.001 + dat$lat[i] ,c(0,0,1164.7,1164.7) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001 - 0.005*0.05 + dat$lat[i] ,c(0,0,1729,1729) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001 + 0.005*0.05 + dat$lat[i] ,c(0,0,1729,1729) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
}
if (dat$Name[i] == "Trump International Hotel and Tower"){
col <- rgb(0, (dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20,alpha)
polygon(c(-1.5,1.5,1.5,-1.5)*0.001 + dat$lat[i] ,c(0,0,246,246) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1.5,1,1,-1.5)*0.001 + dat$lat[i] ,c(246,246,410,410) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1,1,1,-1)*0.001 + dat$lat[i] ,c(410,410,705,705) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1,.5,.5,-1)*0.001 + dat$lat[i] ,c(705,705,1116,1116) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.5,.5,.5,-.5)*0.001 + dat$lat[i] ,c(1116,1116,1171,1171) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001  + dat$lat[i] ,c(1171,1171,1388,1388) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
}
if (dat$Name[i] == "Two Prudential Plaza"){print("greg")
col <- rgb((dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20,alpha)
polygon(c(-.05,.05,.05,-.05)*0.001  + dat$lat[i] ,c(995-80,995-80,995,995) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.5,.5,0.05,-0.05)*0.001  + dat$lat[i] ,c(dat$height[i],dat$height[i],995-80,995-80) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
#text(dat$lat[i],dat$height[i],dat$Name[i],srt = 90)
}
}
dat <- dat[order(dat$long),]
alpha <- 0.75
offset <- -1
plot(0,0,xlim = c(41.875,41.905),ylim = c(-500,1560),frame.plot= FALSE, xlab = "", ylab = "", yaxt= 'n',xaxt='n',asp = 1/150000,col="white")
for (i in 1:nrow(dat)){
col <- rgb((dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20, alpha)
if (dat$Name[i] == "CNA Center"){col <- rgb((dat$long[i] + 87.65) * 20, 0,0,alpha)}
if (dat$Name[i] == "Trump International Hotel and Tower"){col <- rgb(0,(dat$long[i] + 87.65) * 20,(dat$long[i] + 87.65) * 20,alpha)}
if (dat$Name[i] == "Willis Tower"){col <- rgb(0, 0,0)}
if (dat$Name[i] == "875 North Michigan Avenue"){col <- rgb(0, 0,0)}
polygon(c(-0.5,0.5,0.5,-0.5)*0.001 + dat$lat[i] ,c(0,0,dat$height[i],dat$height[i]) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
if (dat$Name[i] == "875 North Michigan Avenue"){
polygon(c(-1,1,0.5,-0.5)*0.001 + dat$lat[i] ,c(0,0,dat$height[i],dat$height[i]) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001 - 0.005*0.05 + dat$lat[i] ,c(dat$height[i],dat$height[i],1500,1500) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001 + 0.005*0.05 + dat$lat[i] ,c(dat$height[i],dat$height[i],1500,1500) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
}
if (dat$Name[i] == "Willis Tower"){
polygon(c(-1,1,1,-1)*0.001 + dat$lat[i] ,c(0,0,656.168,656.168) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.75,.75,.75,-.75)*0.001 + dat$lat[i] ,c(0,0,1164.7,1164.7) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001 - 0.005*0.05 + dat$lat[i] ,c(0,0,1729,1729) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001 + 0.005*0.05 + dat$lat[i] ,c(0,0,1729,1729) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
}
if (dat$Name[i] == "Trump International Hotel and Tower"){
col <- rgb(0, (dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20,alpha)
polygon(c(-1.5,1.5,1.5,-1.5)*0.001 + dat$lat[i] ,c(0,0,246,246) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1.5,1,1,-1.5)*0.001 + dat$lat[i] ,c(246,246,410,410) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1,1,1,-1)*0.001 + dat$lat[i] ,c(410,410,705,705) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1,.5,.5,-1)*0.001 + dat$lat[i] ,c(705,705,1116,1116) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.5,.5,.5,-.5)*0.001 + dat$lat[i] ,c(1116,1116,1171,1171) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001  + dat$lat[i] ,c(1171,1171,1388,1388) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
}
if (dat$Name[i] == "Two Prudential Plaza"){print("greg")
col <- rgb((dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20,alpha)
polygon(c(-.05,.05,.05,-.05)*0.001  + dat$lat[i] ,c(995-80,995-80,995,995) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.5,.5,0.05,-0.05)*0.001  + dat$lat[i] ,c(dat$height[i],dat$height[i],995-80,995-80) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
#text(dat$lat[i],dat$height[i],dat$Name[i],srt = 90)
}
}
dat <- dat[order(dat$long),]
alpha <- 0.75
offset <- 0
plot(0,0,xlim = c(41.875,41.905),ylim = c(-500,1560),frame.plot= FALSE, xlab = "", ylab = "", yaxt= 'n',xaxt='n',asp = 1/150000,col="white")
for (i in 1:nrow(dat)){
col <- rgb((dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20, alpha)
if (dat$Name[i] == "CNA Center"){col <- rgb((dat$long[i] + 87.65) * 20, 0,0,alpha)}
if (dat$Name[i] == "Trump International Hotel and Tower"){col <- rgb(0,(dat$long[i] + 87.65) * 20,(dat$long[i] + 87.65) * 20,alpha)}
if (dat$Name[i] == "Willis Tower"){col <- rgb(0, 0,0)}
if (dat$Name[i] == "875 North Michigan Avenue"){col <- rgb(0, 0,0)}
polygon(c(-0.5,0.5,0.5,-0.5)*0.001 + dat$lat[i] ,c(0,0,dat$height[i],dat$height[i]) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
if (dat$Name[i] == "875 North Michigan Avenue"){
polygon(c(-1,1,0.5,-0.5)*0.001 + dat$lat[i] ,c(0,0,dat$height[i],dat$height[i]) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001 - 0.005*0.05 + dat$lat[i] ,c(dat$height[i],dat$height[i],1500,1500) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001 + 0.005*0.05 + dat$lat[i] ,c(dat$height[i],dat$height[i],1500,1500) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
}
if (dat$Name[i] == "Willis Tower"){
polygon(c(-1,1,1,-1)*0.001 + dat$lat[i] ,c(0,0,656.168,656.168) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.75,.75,.75,-.75)*0.001 + dat$lat[i] ,c(0,0,1164.7,1164.7) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001 - 0.005*0.05 + dat$lat[i] ,c(0,0,1729,1729) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001 + 0.005*0.05 + dat$lat[i] ,c(0,0,1729,1729) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
}
if (dat$Name[i] == "Trump International Hotel and Tower"){
col <- rgb(0, (dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20,alpha)
polygon(c(-1.5,1.5,1.5,-1.5)*0.001 + dat$lat[i] ,c(0,0,246,246) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1.5,1,1,-1.5)*0.001 + dat$lat[i] ,c(246,246,410,410) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1,1,1,-1)*0.001 + dat$lat[i] ,c(410,410,705,705) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-1,.5,.5,-1)*0.001 + dat$lat[i] ,c(705,705,1116,1116) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.5,.5,.5,-.5)*0.001 + dat$lat[i] ,c(1116,1116,1171,1171) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.05,.05,.05,-.05)*0.001  + dat$lat[i] ,c(1171,1171,1388,1388) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
}
if (dat$Name[i] == "Two Prudential Plaza"){print("greg")
col <- rgb((dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20, (dat$long[i] + 87.65) * 20,alpha)
polygon(c(-.05,.05,.05,-.05)*0.001  + dat$lat[i] ,c(995-80,995-80,995,995) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
polygon(c(-.5,.5,0.05,-0.05)*0.001  + dat$lat[i] ,c(dat$height[i],dat$height[i],995-80,995-80) - offset*15000*(dat$long[i] + 87.64) ,col = col,lwd = 0.00001)
#text(dat$lat[i],dat$height[i],dat$Name[i],srt = 90)
}
}
wave.des <- function(set, nmiss, ...) { # nmiss is the number of days each person would miss? 11?? Like, miss a fourth of the days?
id <- sample(2:5, size=nmiss)
for (i in 1:nmiss) {
set[set$day %in% id[i], c('Q1','Q2','Q3','Q4','Q5','Q6','Q7','Q8')] <- NA
}
set
}
cols <- c('Q1','Q2','Q3','Q4','Q5','Q6','Q7','Q8')
fill <- matrix(1, 5, 8)
dat <- data.frame(fill)
colnames(dat) <- cols
dat$day <- seq.int(nrow(dat))
split.dat <- split.form(dat,grps)[1:8]
split.dat
split.form <- function(set, nrem = 2, bound = 0){
set[set$Day >= bound, paste0("Q",1:8)] <- t(apply(set[set$Day >= bound,paste0("Q",1:8)], 1, function(x){
ind <- sample(1:8, nrem)
x[ind] <- NA
as.numeric(x)
}))
return(set)
}
cols <- c('Q1','Q2','Q3','Q4','Q5','Q6','Q7','Q8')
fill <- matrix(1, 5, 8)
dat <- data.frame(fill)
colnames(dat) <- cols
dat$day <- seq.int(nrow(dat))
split.dat <- split.form(dat,grps)[1:8]
split.dat
split.dat <- split.form(dat)[1:8]
cols <- c('Q1','Q2','Q3','Q4','Q5','Q6','Q7','Q8')
fill <- matrix(1, 5, 8)
dat <- data.frame(fill)
colnames(dat) <- cols
dat$day <- seq.int(nrow(dat))
split.dat <- split.form(dat)
split.form(dat)
dat[1,]
dat
dat$Day <- seq.int(nrow(dat))
split.dat <- split.form(dat)[1:8]
split.dat
library(ggplot2)
library(dplyr)
library(reshape2)
datmelt <- split.dat[1:8] %>% is.na %>% melt
colnames(datmelt) <- c("Day","Question","Missing")
datmelt$block <- ifelse((datmelt$Question=="Q1")|(datmelt$Question=="Q8"),"X",ifelse((datmelt$Question=="Q2")|(datmelt$Question=="Q3"),"A",ifelse((datmelt$Question=="Q4")|(datmelt$Question=="Q5"),"B",ifelse((datmelt$Question=="Q6")|(datmelt$Question=="Q7"),"C",0))))
datmelt$color <- ifelse(datmelt$Missing == "TRUE", "Missing", ifelse(datmelt$block == "X","X",ifelse(datmelt$block == "A","A",ifelse(datmelt$block == "B","B",ifelse(datmelt$block == "C","C","Missing")))))
cols <- c("A" = "skyblue3", "B" = "skyblue3", "C" = "skyblue3", "X" = "skyblue4", "Missing" = "white")
ggplot(datmelt, aes(Question, Day, fill=color)) + geom_raster() + scale_fill_manual(values =
cols) + geom_vline(xintercept=seq(1.5, 7.5, 2), lwd=1, colour="white") + geom_hline(yintercept=seq(1.5, 4.5, 1), lwd=1, colour="white") + theme(axis.text.x = element_text(angle=45, vjust=0.5),panel.background = element_rect(fill = NA)) + labs(x = "Questions Asked",y = "Day",fill="Block") + scale_y_reverse()
datmelt
cols <- c("A" = "skyblue3", "B" = "skyblue3", "C" = "skyblue3", "X" = "skyblue4", "Missing" = "red")
ggplot(datmelt, aes(Question, Day, fill=color)) + geom_raster() + scale_fill_manual(values = cols) + geom_vline(xintercept=seq(1.5, 7.5, 2), lwd=1, colour="white") + geom_hline(yintercept=seq(1.5, 4.5, 1), lwd=1, colour="white") + theme(axis.text.x = element_text(angle=45, vjust=0.5),panel.background = element_rect(fill = NA)) + labs(x = "Questions Asked",y = "Day",fill="Block") + scale_y_reverse()
ggplot(datmelt, aes(Question, Day, fill=color)) + geom_raster() + scale_fill_manual(values = cols)  + theme(axis.text.x = element_text(angle=45, vjust=0.5),panel.background = element_rect(fill = NA)) + labs(x = "Questions Asked",y = "Day",fill="Block") + scale_y_reverse()
datmelt <- split.dat[1:8] %>% is.na %>% melt
colnames(datmelt) <- c("Day","Question","Missing")
datmelt$color <- ifelse(datmelt$Missing == "TRUE", "Missing", ifelse(datmelt$block == "X","X",ifelse(datmelt$block == "A","A",ifelse(datmelt$block == "B","B",ifelse(datmelt$block == "C","C","Missing")))))
datmelt$color <- ifelse(datmelt$Missing == "TRUE", "Missing", "Observed")
cols <- c("Missing" = "red", "Observed" = "skyblue3")
ggplot(datmelt, aes(Question, Day, fill=color)) + geom_raster() + scale_fill_manual(values = cols)  + theme(axis.text.x = element_text(angle=45, vjust=0.5),panel.background = element_rect(fill = NA)) + labs(x = "Questions Asked",y = "Day",fill="Block") + scale_y_reverse()
ggplot(datmelt, aes(Question, Day, fill=color)) + geom_raster()
ggplot(datmelt, aes(Question, Day, fill=color)) + geom_raster() + scale_fill_manual(values = cols)
ggplot(datmelt, aes(Question, Day, fill=color)) + geom_raster() + scale_fill_manual(values = cols)  + theme(axis.text.x = element_text(angle=45, vjust=0.5),panel.background = element_rect(fill = NA))
ggplot(datmelt, aes(Question, Day, fill=color)) + geom_raster() + scale_fill_manual(values = cols)  + theme(axis.text.x = element_text(angle=45, vjust=0.5),panel.background = element_rect(fill = NA)) + labs(x = "Questions Asked",y = "Day",fill="Block")
ggplot(datmelt, aes(Question, Day, fill=color)) + geom_raster() + scale_fill_manual(values = cols)  + theme(axis.text.x = element_text(angle=45, vjust=0.5),panel.background = element_rect(fill = NA)) + labs(x = "Questions Asked",y = "Day",fill="Block") + scale_y_reverse()
ggplot(datmelt, aes(Question, Day, fill=color)) + geom_raster() + scale_fill_manual(values = cols)  + theme(axis.text.x = element_text(angle=45, vjust=0.5),panel.background = element_rect(fill = NA)) + labs(x = "Questions Asked",y = "Day",fill="Block") + scale_y_reverse() + theme(legend.title=element_blank())
matrix(1, 5, 8)
cols <- c('Q1','Q2','Q3','Q4','Q5','Q6','Q7','Q8')
fill <- matrix(1, 20, 8)
dat <- data.frame(fill)
colnames(dat) <- cols
dat$Day <- seq.int(nrow(dat))
split.dat <- split.form(dat)[1:8]
split.dat
>>>>>>> e081cde1cac78d4ae99415fc3ba7e49b1d77737a
library(ggplot2)
library(dplyr)
library(reshape2)
datmelt <- split.dat[1:8] %>% is.na %>% melt
colnames(datmelt) <- c("Day","Question","Missing")
<<<<<<< HEAD
#datmelt$block <- ifelse((datmelt$Question=="Q1")|(datmelt$Question=="Q8"),"X",ifelse((datmelt$Question=="Q2")|(datmelt$Question=="Q3"),"A",ifelse((datmelt$Question=="Q4")|(datmelt$Question=="Q5"),"B",ifelse((datmelt$Question=="Q6")|(datmelt$Question=="Q7"),"C",0))))
datmelt$color <- ifelse(datmelt$Missing == "TRUE", "Missing", "Observed")
#ifelse(datmelt$Missing == "TRUE", "Missing", ife
cols <- c("Missing" = "red", "Observed" = "skyblue3")
splitplot <- ggplot(datmelt, aes(Question, Day, fill=color)) + geom_raster() + scale_fill_manual(values = cols)  + theme(axis.text.x = element_text(angle=45, vjust=0.5),panel.background = element_rect(fill = NA)) + labs(x = "Questions Asked",y = "Day",fill="Block") + scale_y_reverse() + theme(legend.title=element_blank(),legend.position="none")
datmelt <- split.dat[1:8] %>% is.na %>% melt
cols <- c('Q1','Q2','Q3','Q4','Q5','Q6','Q7','Q8')
fill <- matrix(1, 45, 8)
dat <- data.frame(fill)
colnames(dat) <- cols
dat$Day <- seq.int(nrow(dat))
set.seed(1234)
split.dat <- split.form(dat)[1:8]
=======
datmelt$color <- ifelse(datmelt$Missing == "TRUE", "Missing", "Observed")
cols <- c("Missing" = "red", "Observed" = "skyblue3")
ggplot(datmelt, aes(Question, Day, fill=color)) + geom_raster() + scale_fill_manual(values = cols)  + theme(axis.text.x = element_text(angle=45, vjust=0.5),panel.background = element_rect(fill = NA)) + labs(x = "Questions Asked",y = "Day",fill="Block") + scale_y_reverse() + theme(legend.title=element_blank())
set.seed(1234)
split.dat <- split.form(dat)[1:8]
split.dat
>>>>>>> e081cde1cac78d4ae99415fc3ba7e49b1d77737a
library(ggplot2)
library(dplyr)
library(reshape2)
datmelt <- split.dat[1:8] %>% is.na %>% melt
colnames(datmelt) <- c("Day","Question","Missing")
<<<<<<< HEAD
#datmelt$block <- ifelse((datmelt$Question=="Q1")|(datmelt$Question=="Q8"),"X",ifelse((datmelt$Question=="Q2")|(datmelt$Question=="Q3"),"A",ifelse((datmelt$Question=="Q4")|(datmelt$Question=="Q5"),"B",ifelse((datmelt$Question=="Q6")|(datmelt$Question=="Q7"),"C",0))))
datmelt$color <- ifelse(datmelt$Missing == "TRUE", "Missing", "Observed")
#ifelse(datmelt
split.form <- function(set, nrem = 2, bound = 0){
set[set$Day >= bound, paste0("Q",1:8)] <- t(apply(set[set$Day >= bound,paste0("Q",1:8)], 1, function(x){
ind <- sample(1:8, nrem)
x[ind] <- NA
as.numeric(x)
}))
return(set)
}
wave.des <- function(set, nmiss, ...) { # nmiss is the number of days each person would miss? 11?? Like, miss a fourth of the days?
id <- sample(2:45, size=nmiss)
=======
datmelt$color <- ifelse(datmelt$Missing == "TRUE", "Missing", "Observed")
cols <- c("Missing" = "red", "Observed" = "skyblue3")
ggplot(datmelt, aes(Question, Day, fill=color)) + geom_raster() + scale_fill_manual(values = cols)  + theme(axis.text.x = element_text(angle=45, vjust=0.5),panel.background = element_rect(fill = NA)) + labs(x = "Questions Asked",y = "Day",fill="Block") + scale_y_reverse() + theme(legend.title=element_blank())
dat
wave.dat <- wave.des(dat,8)
wave.dat
wave.dat <- wave.des(dat,8)
wave.des <- function(set, nmiss, ...) { # nmiss is the number of days each person would miss? 11?? Like, miss a fourth of the days?
id <- sample(2:20, size=nmiss)
for (i in 1:nmiss) {
set[set$day %in% id[i], c('Q1','Q2','Q3','Q4','Q5','Q6','Q7','Q8')] <- NA
}
set
}
wave.dat <- wave.des(dat,8)
wave.dat
wave.dat <- wave.des(dat,8)
wave.dat
nmiss <- 8
sample(2:20, size=nmiss)
id <- sample(2:20, size=nmiss)
for (i in 1:nmiss) {
set[set$day %in% id[i], c('Q1','Q2','Q3','Q4','Q5','Q6','Q7','Q8')] <- NA
}
set
set <- dat
wave.dat <- wave.des(dat,8)
wave.dat
wave.des <- function(set, nmiss, ...) { # nmiss is the number of days each person would miss? 11?? Like, miss a fourth of the days?
id <- sample(2:20, size=nmiss)
for (i in 1:nmiss) {
set[set$day %in% id[i], c('Q1','Q2','Q3','Q4','Q5','Q6','Q7','Q8')] <- NA
}
return(set)
}
wave.dat <- wave.des(dat,8)
wave.dat
wave.des
wave.des <- function(set, nmiss, ...) { # nmiss is the number of days each person would miss? 11?? Like, miss a fourth of the days?
id <- sample(2:20, size=nmiss)
>>>>>>> e081cde1cac78d4ae99415fc3ba7e49b1d77737a
for (i in 1:nmiss) {
set[set$Day %in% id[i], c('Q1','Q2','Q3','Q4','Q5','Q6','Q7','Q8')] <- NA
}
return(set)
}
<<<<<<< HEAD
cols <- c('Q1','Q2','Q3','Q4','Q5','Q6','Q7','Q8')
fill <- matrix(1, 45, 8)
dat <- data.frame(fill)
colnames(dat) <- cols
dat$Day <- seq.int(nrow(dat))
set.seed(1234)
split.dat <- split.form(dat)[1:8]
library(ggplot2)
library(dplyr)
library(reshape2)
datmelt <- split.dat[1:8] %>% is.na %>% melt
colnames(datmelt) <- c("Day","Question","Missing")
#datmelt$block <- ifelse((datmelt$Question=="Q1")|(datmelt$Question=="Q8"),"X",ifelse((datmelt$Question=="Q2")|(datmelt$Question=="Q3"),"A",ifelse((datmelt$Question=="Q4")|(datmelt$Question=="Q5"),"B",ifelse((datmelt$Question=="Q6")|(datmelt$Question=="Q7"),"C",0))))
datmelt$color <- ifelse(datmelt$Missing == "TRUE", "Missing", "Observed")
#i
cols <- c("Missing" = "red", "Observed" = "skyblue3")
splitplot <- ggplot(datmelt, aes(Question, Day, fill=color)) + geom_raster() + scale_fill_manual(values = cols)  + theme(axis.text.x = element_text(angle=45, vjust=0.5),panel.background = element_rect(fill = NA)) + labs(x = "Questions Asked",y = "Day",fill="Block") + scale_y_reverse() + theme(legend.title=element_blank(),legend.position="none")
cols <- c('Q1','Q2','Q3','Q4','Q5','Q6','Q7','Q8')
fill <- matrix(1, 45, 8)
=======
wave.dat <- wave.des(dat,8)
wave.dat
set.seed(1234)
wave.dat <- wave.des(dat,8)
wave.dat
datmelt <- split.dat[1:8] %>% is.na %>% melt
datmelt <- wave.dat[1:8] %>% is.na %>% melt
colnames(datmelt) <- c("Day","Question","Missing")
datmelt$color <- ifelse(datmelt$Missing == "TRUE", "Missing", "Observed")
cols <- c("Missing" = "red", "Observed" = "skyblue3")
ggplot(datmelt, aes(Question, Day, fill=color)) + geom_raster() + scale_fill_manual(values = cols)  + theme(axis.text.x = element_text(angle=45, vjust=0.5),panel.background = element_rect(fill = NA)) + labs(x = "Questions Asked",y = "Day",fill="Block") + scale_y_reverse() + theme(legend.title=element_blank())
cols <- c('Q1','Q2','Q3','Q4','Q5','Q6','Q7','Q8')
fill <- matrix(1, 20, 8)
dat <- data.frame(fill)
colnames(dat) <- cols
dat$Day <- seq.int(nrow(dat))
set.seed(1234)
split.dat <- split.form(dat,2)[1:8]
split.dat
cols <- c('Q1','Q2','Q3','Q4','Q5','Q6','Q7','Q8')
fill <- matrix(1, 20, 8)
dat <- data.frame(fill)
colnames(dat) <- cols
dat$Day <- seq.int(nrow(dat))
set.seed(1234)
split.dat <- split.form(dat, bound = 2)[1:8]
split.dat
split.dat <- split.form(dat, bound = 3)[1:8]
split.dat
cols <- c('Q1','Q2','Q3','Q4','Q5','Q6','Q7','Q8')
fill <- matrix(1, 20, 8)
>>>>>>> e081cde1cac78d4ae99415fc3ba7e49b1d77737a
dat <- data.frame(fill)
colnames(dat) <- cols
dat$Day <- seq.int(nrow(dat))
set.seed(1234)
alternate.split.dat <- split.form(dat, bound = 3)[1:8]
<<<<<<< HEAD
#
=======
alternate.split.dat
>>>>>>> e081cde1cac78d4ae99415fc3ba7e49b1d77737a
library(ggplot2)
library(dplyr)
library(reshape2)
datmelt <- alternate.split.dat[1:8] %>% is.na %>% melt
colnames(datmelt) <- c("Day","Question","Missing")
<<<<<<< HEAD
#datmelt$block <- ifelse((datmelt$Question=="Q1")|(datmelt$Question=="Q8"),"X",ifelse((datmelt$Question=="Q2")|(datmelt$Question=="Q3"),"A",ifelse((datmelt$Question=="Q4")|(datmelt$Question=="Q5"),"B",ifelse((datmelt$Question=="Q6")|(datmelt$Question=="Q7"),"C",0))))
datmelt$color <- ifelse(datmelt$Missing == "TRUE", "Missing", "Observed")
cols <- c("Missing" = "red", "Observed" = "skyblue3")
alternatesplitplot <- ggplot(datmelt, aes(Question, Day, fill=color)) + geom_raster() + scale_fill_manual(values = cols)  + theme(axis.text.x = element_text(angle=45, vjust=0.5),panel.background = element_rect(fill = NA)) + labs(x = "Questions Asked",y = "Day",fill="Block") + scale_y_reverse() + theme(legend.title=element_blank(),legend.position="none")
set.seed(1234)
wave.dat <- wave.des(dat,11)
#wave.
library(ggplot2)
library(dplyr)
library(reshape2)
datmelt <- wave.dat[1:8] %>% is.na %>% melt
colnames(datmelt) <- c("Day","Question","Missing")
#datmelt$block <- ifelse((datmelt$Question=="Q1")|(datmelt$Question=="Q8"),"X",ifelse((datmelt$Question=="Q2")|(datmelt$Question=="Q3"),"A",ifelse((datmelt$Question=="Q4")|(datmelt$Question=="Q5"),"B",ifelse((datmelt$Question=="Q6")|(datmelt$Question=="Q7"),"C",0))))
datmelt$color <- ifelse(datmelt$Missing == "TRUE", "Missing", "Observed")
cols <- c("Missing" = "red", "Observed" = "skyblue3")
waveplot <-  ggplot(datmelt, aes(Question, Day, fill=color)) + geom_raster() + scale_fill_manual(values = cols)  + theme(axis.text.x = element_text(angle=45, vjust=0.5),panel.background = element_rect(fill = NA)) + labs(x = "Questions Asked",y = "Day",fill="Block") + scale_y_reverse() + theme(legend.title=element_blank(),legend.position="none")
grid.arrange(splitplot, alternatesplitplot, waveplot, ncol=3)
load("~/GitHub/designedmissingness/Results/tables20180509_60_1_high_hightime0.RData")
high_7 <- d
load("~/GitHub/designedmissingness/Results/tables20180509_60_1_med_hightime0.RData")
med_7 <- d
load("~/GitHub/designedmissingness/Results/tables20180509_60_1_low_hightime0.RData")
low_7 <- d
high_7
med_7
library(knitr)
kable(cbind("","","",rbind(low[[1]],med[[1]],high[[1]],low[[2]],med[[2]],high[[2]],low[[3]],med[[3]],high[[3]])),format="latex")
kable(cbind("","","",rbind(low_8[[1]],med_8[[1]],high_8[[1]],low_8[[2]],med_8[[2]],high_8[[2]],low_8[[3]],med_8[[3]],high_8[[3]])),format="latex")
load("~/GitHub/designedmissingness/Results/tables20180509_60_1_high_hightime0.RData")
high_8 <- d
load("~/GitHub/designedmissingness/Results/tables20180509_60_1_med_hightime0.RData")
med_8 <- d
load("~/GitHub/designedmissingness/Results/tables20180509_60_1_low_hightime0.RData")
low_8 <- d
library(knitr)
kable(cbind("","","",rbind(low_8[[1]],med_8[[1]],high_8[[1]],low_8[[2]],med_8[[2]],high_8[[2]],low_8[[3]],med_8[[3]],high_8[[3]])),format="latex")
df_8 <- data.frame(Design = rep(c("Split Form","Altered Split Form", "Wave Missingness"), each = 12))
df_8
df_8 <- data.frame(Design = rep(c("Split Form","Altered Split Form", "Wave Missingness"), each = 12), Missingness = rep(rep(c("Low","Medium", "High"), each = 4),3))
df_8
df_8 <- data.frame(Design = rep(c("Split Form","Altered Split Form", "Wave Missingness"), each = 12), Missingness = rep(rep(c("Low","Medium", "High"), each = 4),3), Parameter = rep(c("$\gamma_0$", "$\beta_1$", "$\beta_2$", "$\beta_3$"),9))
df_8 <- data.frame(Design = rep(c("Split Form","Altered Split Form", "Wave Missingness"), each = 12), Missingness = rep(rep(c("Low","Medium", "High"), each = 4),3), Parameter = rep(c("$\\gamma_0$", "$\\beta_1$", "$\\beta_2$", "$\\beta_3$"),9))
df_8
kable(df_8, escape=FALSE, format="latex")
c8 <- rbind(low_8[[1]],med_8[[1]],high_8[[1]],low_8[[2]],med_8[[2]],high_8[[2]],low_8[[3]],med_8[[3]],high_8[[3]])
c8
df_8 <- data.frame(Design = rep(c("Split Form","Altered Split Form", "Wave Missingness"), each = 12), Missingness = rep(rep(c("Low","Medium", "High"), each = 4),3), Parameter = rep(c("$\\gamma_0$", "$\\beta_1$", "$\\beta_2$", "$\\beta_3$"),9), Bias = c8["Bias"], "% Bias" = c8["% Bias"])
df_8 <- data.frame(Design = rep(c("Split Form","Altered Split Form", "Wave Missingness"), each = 12), Missingness = rep(rep(c("Low","Medium", "High"), each = 4),3), Parameter = rep(c("$\\gamma_0$", "$\\beta_1$", "$\\beta_2$", "$\\beta_3$"),9), Bias = c8["Bias"], "% Bias" = c8["Pct Bias"])
df_8
names(df_8)
names(df_8)[5] <- "% Bias"
names(df_8)
df_8
c8
df_8 <- data.frame(Design = rep(c("Split Form","Altered Split Form", "Wave Missingness"), each = 12), Missingness = rep(rep(c("Low","Medium", "High"), each = 4),3), Parameter = rep(c("$\\gamma_0$", "$\\beta_1$", "$\\beta_2$", "$\\beta_3$"),9), Bias = c8["Bias"], "% Bias" = c8["Pct Bias"], MSE = c8["MSE"], Coverage= c8["Coverage"], c8["CI Length"], FMI = c8["FMI"])
df_8
names(df_8)
names(df_8) <- c("Design", "Missingness", "Parameter", "Bias", "% Bias", "MSE", "Coverage", "CI Length", "FMI")
df_8
kable(df_8, escape=FALSE, format="latex")
df_8
df_8 <- data.frame(Design = rep(c("Split Form","Altered Split Form", "Wave Missingness"), each = 12), Missingness = rep(rep(c("Low","Medium", "High"), each = 4),3), Parameter = rep(c("$\\gamma_0$", "$\\beta_1$", "$\\beta_2$", "$\\beta_3$"),9), Bias = c8["Bias"], c8["Pct Bias"], MSE = c8["MSE"], Coverage= c8["Coverage"], c8["CI Length"], FMI = c8["FMI"])
names(df_8) <- c("Design", "Missingness", "Parameter", "Bias", "Pct Bias", "MSE", "Coverage", "CI Length", "FMI")
kable(df_8, escape = FALSE, format ="latex", digits = 3)
install.packages("kableExtra")
# Table 7
library(kableExtra)
library(dplyr)
df_8[,4:9] <- apply(df_8[,4:9], 2, round, digits = 3)
str(df_8)
df_8 <- data.frame(Design = rep(c("Split Form","Altered Split Form", "Wave Missingness"), each = 12), Missingness = rep(rep(c("Low","Medium", "High"), each = 4),3), Parameter = rep(c("$\\gamma_0$", "$\\beta_1$", "$\\beta_2$", "$\\beta_3$"),9), Bias = unlist(c8["Bias"]), unlist(c8["Pct Bias"]), MSE = unlist(c8["MSE"]), Coverage = c8["Coverage"], c8["CI Length"], FMI = c8["FMI"])
str(df_8)
df_8[,4:9] <- apply(df_8[,4:9], 2, round, digits = 3)
df_8
df_8
df_8 <- data.frame(Design = rep(c("Split Form","Altered Split Form", "Wave Missingness"), each = 12), Missingness = rep(rep(c("Low","Medium", "High"), each = 4),3), Parameter = rep(c("$\\gamma_0$", "$\\beta_1$", "$\\beta_2$", "$\\beta_3$"),9), Bias = unlist(c8["Bias"]), unlist(c8["Pct Bias"]), MSE = unlist(c8["MSE"]), Coverage = c8["Coverage"], c8["CI Length"], FMI = c8["FMI"])
df_8[,4:9] <- apply(df_8[,4:9], 2, round, digits = 3)
names(df_8) <- c("Design", "Level", "Parameter", "Bias", "Pct Bias", "MSE", "Coverage", "CI Length", "FMI")
row.names(df_8) <- NULL
df_8
=======
datmelt$color <- ifelse(datmelt$Missing == "TRUE", "Missing", "Observed")
cols <- c("Missing" = "red", "Observed" = "skyblue3")
ggplot(datmelt, aes(Question, Day, fill=color)) + geom_raster() + scale_fill_manual(values = cols)  + theme(axis.text.x = element_text(angle=45, vjust=0.5),panel.background = element_rect(fill = NA)) + labs(x = "Questions Asked",y = "Day",fill="Block") + scale_y_reverse() + theme(legend.title=element_blank())
require(gridExtra)
split.intervals <- TD(splitmods)
fmi <- function(mods){
FMI <- matrix(NA, nrow = length(mods), ncol = length(mods[[1]]$betas[[1]]))
for (i in 1:no.sim){
B <- apply(do.call(rbind,mods[[i]]$betas),2,var)
W <- apply(do.call(rbind,mods[[i]]$se)^2,2,mean)
# Combined variance
TD <- (1 + 1/length(mods))*B + W
FMI[i,] <- ((1 + (1/length(mods)))*B)/TD
}
return(apply(FMI, 2, mean))
}
split.fmi <- fmi(splitmods)
altered.split.fmi <- fmi(alteredsplitmods)
wave.fmi <- fmi(wavemods)
split.table <- data.frame(split.cover[2],cbind(split.bias,split.mse),split.fmi,split.length,split.pctbias)
d <- list(split.table,altered.split.table,wave.table)
save(d, file = paste0("/home/gmatthews1/designedMissingness/tables20180509_",no.pid,"_",corr.scale,"_",howmuch,"_hightime",hightime,".RData"))
lapply(split.intervals,function(x){x[2,3]})
d <- list(split.table,altered.split.table,wave.table)
save(d, file = paste0("/home/gmatthews1/designedMissingness/tables20180509_",no.pid,"_",corr.scale,"_",howmuch,"_hightime",hightime,".RData"))
d <- list(split.table,altered.split.table,wave.table)
save(d, file = paste0("/home/gmatthews1/designedMissingness/tables20180509_",no.pid,"_",corr.scale,"_",howmuch,"_hightime",hightime,".RData"))
d <- list(split.table,altered.split.table,wave.table)
save(d, file = paste0("/home/gmatthews1/designedMissingness/tables20180509_",no.pid,"_",corr.scale,"_",howmuch,"_hightime",hightime,".RData"))
>>>>>>> e081cde1cac78d4ae99415fc3ba7e49b1d77737a
